%%%%%%%%%%%%%%%%%%%%%%%%
%% Sample use of the infthesis class to prepare a thesis. This can be used as 
%% a template to produce your own thesis.
%%
%% The title, abstract and so on are taken from Martin Reddy's csthesis class
%% documentation.
%%
%% MEF, October 2002
%%%%%%%%%%%%%%%%%%%%%%%%

%%%%
%% Load the class. Put any options that you want here (see the documentation
%% for the list of options). The following are samples for each type of
%% thesis:
%%
%% Note: you can also specify any of the following options:
%% logo: put a University of Edinburgh logo onto the title page
%% frontabs: put the abstract onto the title page
%% deptreport: produce a title page that fits into a Computer Science
%%   departmental cover [not sure if this actually works]
%% singlespacing, fullspacing, doublespacing: choose line spacing
%% oneside, twoside: specify a one-sided or two-sided thesis
%% 10pt, 11pt, 12pt: choose a font size
%% centrechapter, leftchapter, rightchapter: alignment of chapter headings
%% sansheadings, normalheadings: headings and captions in sans-serif
%%   (default) or in the same font as the rest of the thesis
%% [no]listsintoc: put list of figures/tables in table of contents (default:
%%   not)
%% romanprepages, plainprepages: number the preliminary pages with Roman
%%   numerals (default) or consecutively with the rest of the thesis
%% parskip: don't indent paragraphs, put a blank line between instead
%% abbrevs: define a list of useful abbreviations (see documentation)
%% draft: produce a single-spaced, double-sided thesis with narrow margins
%%
%% For a PhD thesis -- you must also specify a research institute:
\documentclass[phd,ianc,oneside,logo,doublespacing,sansheadings,romanprepages,parskip]{infthesis}
\pdfoutput=1

%% For an MPhil thesis -- also needs an institute
% \documentclass[mphil,ianc]{infthesis}

%% MSc by Research, which also needs an institute
% \documentclass[mscres,irr]{infthesis}

%% Taught MSc -- specify a particular degree instead. If none is specified,
%% "MSc in Informatics" is used.
% \documentclass[msc,cogsci]{infthesis}
% \documentclass[msc]{infthesis} % for the MSc in Informatics

%% Master of Informatics (5 year degree)
% \documentclass[minf]{infthesis}

%% Undergraduate project -- specify the degree course and project type
%% separately
% \documentclass[bsc]{infthesis}
% \course{Artificial Intelligence and Psychology}
% \project{Fourth Year Project Report}

%% Put any \usepackage commands you want to use right here; the following is 
%% an example:
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}  % use 8-bit T1 fonts
\usepackage{hyperref}    % hyperlinks
\usepackage{url}      % simple URL typesetting
\usepackage{booktabs}    % professional-quality tables
\usepackage{amsfonts}    % blackboard math symbols
\usepackage{amsmath}
\usepackage{bm}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\newcommand{\triangleq}{=\mathrel{\mathop:}}
\usepackage{nicefrac}    % compact symbols for 1/2, etc.
\usepackage{microtype}   % microtypography
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{float}
\usepackage[natbibapa]{apacite}
\usepackage{pdfpages}
\bibliographystyle{apacite}

%\usepackage{algpseudocode,algorithm,algorithmicx}
\usepackage[ruled,vlined]{algorithm2e}
% additional styling
\setlength{\parindent}{0pt}
\linespread{1.25}


\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{float}

\newcommand{\KL}{D_\mathrm{KL}}
\newcommand{\E}{\mathbb{E}}

%% Information about the title, etc.
\title{Applications of the Free Energy Principle to Machine Learning and Neuroscience}
\author{Beren Millidge}

%% If the year of submission is not the current year, uncomment this line and 
%% specify it here:
% \submityear{1785}

%% Optionally, specify the graduation month and year:
% \graduationdate{February 1786}

%% Specify the abstract here.
\abstract{%

In this thesis, we explore and apply methods inspired by the free energy principle to two important areas in machine learning and neuroscience. The free energy principle is a general mathematical theory of the necessary information-theoretic behaviours of systems which maintain a separation from their environment. A core postulate of the theory is that complex systems can be seen as performing variational Bayesian inference and minimizing an information-theoretic quantity called the variational free energy. The free energy principle originated in, and has been extremely influential in theoretical neuroscience, having spawned a number of neurophysiologically realistic process theories, and maintaining close links with Bayesian Brain viewpoints. 

The thesis is split into three main parts where we apply methods and insights from the free energy principle to understand questions first in \emph{perception}, then \emph{action}, and finally \emph{learning}. Specifically, in the first section, we focus on the theory of predictive coding, a neurobiologically plausible process theory derived from the free energy principle under certain assumptions, which argues that the primary function of the brain is to minimize prediction errors. We focus on scaling up predictive coding architectures and simulate large-scale predictive coding networks for perception on machine learning benchmarks; we investigate predictive coding's relationship to other classical filtering algorithms, and we demonstrate that many biologically implausible aspects of current models of predictive coding can be relaxed without unduly harming the performance of predictive coding models which allows for a potentially more literal translation of predictive coding theory into cortical microcircuits.
 
In the second part of the thesis, we focus on the application of methods deriving from the free energy principle to \emph{action}. We study the extension of methods of `active inference', a neurobiologically grounded account of action through variational message passing, to utilize deep artificial neural networks, allowing these methods to `scale up' to be competitive with state of the art deep reinforcement learning methods. Additionally, we show that these active inference inspired methods can bring conceptual clarity and novel perspectives to deep reinforcement learning. We show how active inference reveals the importance of deep generative models and model-based planning for adaptive action, as well as information-seeking exploration which arises under a unified mathematical framework from active inference. Finally, we provide a unified mathematically principled framework for understanding and deriving many information-seeking exploration objectives through the lens of a dichotomy between `evidence' and `divergence' objectives. We show that this distinction is crucial for understanding and relating the many exploratory objectives in both the reinforcement learning, active inference, and cognitive science communities and that this provides a general mathematical framework for specifying the objectives underlying intelligent, adaptive behaviour.

Finally, we focus on applications of the free energy principle to questions of \emph{learning} where we attempt to understand how credit assignment can take place in the brain. First, we demonstrate that, under certain conditions, the predictive coding algorithm can closely approximate the backpropagation of error algorithm along arbitrary computation graphs, which underlies the training of essentially all contemporary machine learning architectures, thus indicating a potential path to the direct implementation of machine learning algorithms in neural circuitry. Finally, we explore other algorithms for biologically plausible credit assignment in the brain, and present Activation Relaxation, a novel algorithm which can approximate backprop using only local learning rules which are substantially simpler than those necessary for predictive coding. We additionally show that the some relaxations that apply to predictive coding, also work for the activation relaxation algorithm, thus producing an extremely elegant and effective algorithm for local approximations to backprop in the brain.

In sum, we believe we have demonstrated the theoretical utility of the free energy principle, by demonstrating how methods inspired by it can interface productively with other fields, specifically neuroscience and machine learning, to develop and improve existing methods, as well as inspire novel advances, in all three areas of perception, action, and learning. Moreover, throughout this thesis, we demonstrate implicitly, the theoretical benefit brought about by the FEPs unified treatment of these seemingly disparate processes, under the rubric of free energy minimization.
}

%% Now we start with the actual document.
\begin{document}



%% First, the preliminary pages
\begin{preliminary}

%pdf forms
%\includepdf[]{thesis_access_form.pdf}
%\includepdf[]{abstract_form.pdf}
%\includepdf[]{thesis_lay_summary.pdf}


%% This creates the title page
\maketitle

%% Acknowledgements
\begin{acknowledgements}
I would like to thank my supervisor, Richard Shillcock, for all his help and advice over the years; for his giving me freedom to work on the topics in this thesis even though they did not align with his planned research trajectory, and for his perseverance in handling my endless drafts. Secondly, a huge thanks to Christopher L Buckley, Alec Tschantz, and Anil Seth for hosting me for a year at the Sackler Centre and the Evolutionary and Adaptive Systems Group (EASY) at the University of Sussex. You have all taught me so much about the craft of research, and without your mentorship and guidance, I would not be half the researcher I am today. I would also like to thank Conor Heins for many stimulating conversations around the free energy principle and related topics. Finally, and above all, I would like to thank my wife, Mycah Banks, for her unending love and support throughout this entire process; her aid with proofreading and figure preparation for many papers, and her sacrifice in putting up with a husband who always has some more research to do. Without you, none of this would be possible. Thank you, Mycah.
\end{acknowledgements}

%% Next we need to have the declaration.
\standarddeclaration

%% Finally, a dedication (this is optional -- uncomment the following line if
%% you want one).
% \dedication{To my mummy.}


%% Create the table of contents
\tableofcontents

%% If you want a list of figures or tables, uncomment the appropriate line(s)
 \listoffigures
% \listoftables

\end{preliminary}

%%%%%%%%
%% Include your chapter files here. See the sample chapter file for the basic
%% format.

\include{chap1}
\include{chap2}
\include{chap3}
\include{chap4}
\include{chap5}
\include{chap6}
\include{chap7}
%% ... etc ...

%%%%%%%%
%% Any appendices should go here. The appendix files should look just like the
%% chapter files.
\appendix
\include{appendix_A}
\include{appendix_B}
\include{Appendix_C}
%% ... etc...

%% Choose your favourite bibliography style here.
%\bibliographystyle{apa}

%% If you want the bibliography single-spaced (which is allowed), uncomment
%% the next line.
% \singlespace

%% Specify the bibliography file. Default is thesis.bib.
\bibliography{thesis}

%% ... that's all, folks!
\end{document}
